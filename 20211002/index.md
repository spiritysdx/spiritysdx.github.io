# 2021年全国大学生数学建模竞赛C题省一等奖论文部分


## 前言

博客展示的是机器转义的markdown格式的，部分内容无法正常展示，完整内容详见博客相关资源。

论文配套的代码均为本人编写，第三四问存在部分代码问题，需要改动细节部分才能运行成功，后面两问的代码时间成本很高，长则数小时，短则十几二十分钟，自己跑酌情修改迭代次数，转换赛题要求的填表格式得通过最后部分的代码才能转换。

省一等奖。。。还是有点小遗憾啊

感谢组员的论文编写和组长和我的解题思路探讨

## 正文


**生产企业原材料的订购与运输策略**

**摘要**

本文研究生产企业原材料订购与运输策略，根据原材料供应商和转运商往年数据，结合产能、成本要求，制定采购以及运输策略，根据不同要求，规划制定企业未来24周最优的原材料订购和转运方案。

针对问题一：利用402家供应商过去250周的订货和供货数据，提取供货商评价特征，综合考虑了供货能力、供货稳定性、供货类别三项指标，建立供货稳定性评价函数为  ，对A、B、C原材料进行加权，利用Borda-排序法建立供应商综合评分体系S，并对得分前50的供应商进行特征分析，分为稳定型供应商和突变型供应商，。

针对问题二：按得分排序，以累积转化产能2.82万为阈值，选取前23家供应商满足企业生产。先制定最经济采购方案，再制定最优转运方案，为两个单目标规划问题。对23家供应商订货量进行规划，稳定供应商过去250周供货量符合正态分布，采用蒙特卡洛算法，突变供应商采用遗传算法预测，突变概率为  目标函数原料成本，迭代循环求解最优值，制定最经济订购方案。周平均最经济订购费用为：20825。以转运历史数据非0平均值作为指标，对转运商进行排序，采用随机抽样法生成未来24周每家转运商转运商的损耗率。转运方案采用逆向选择，转运商按照排名，选择多家供应商进行转运。损耗量最小为目标，利用动态规划进行决策，生成的最优转运方案。

针对问题三：从供给侧调整原材料订购比例，优先选择A类材料供应商合作，重新选取了31家供货商保障生产。该问题为多目标规划，目标为采购成本、转运成本、损耗成本、原料A、C订购量差值，以产能和转运能力为约束，进行多目标规划模型求解，转运方案选择思路同第一问，使得损耗率小的转运商转运数量优先达到最大或接近最大。解得的最优采购以及转运方案，24周的原料和损耗总成本为533642。

针对问题四：依据得分和产品类别，以平均供货累积和48000为阈值，选取134家供货商保障生产。供应商均作为稳定型供应商以简化模型，采用蒙特卡洛算法生成订购表，一家转运商可选取多家供应商提供转运，平均损耗率小的转运商优先选择A类原料供应商，利用动态规划模型求解最佳转运计划，计算总成本S，迭代10000次寻找最优订购以及转运方案。计算周平均产能为7.4万立方米，可得出企业每周的产能可以提高 4.93万立方米。

**关键词：** Borda-排序 蒙特卡洛算法 动态规划 多目标规划

# 一、问题重述

## 1.1 问题背景

某建筑和装饰板材的生产企业在生产中主要用到A、B、C三种不同类型的木质及其他的植物纤维材料。相关材料由订购的原材料供应商（也称&quot;供应商&quot;）进行提供，并由第三方的物流公司（也称&quot;转运商&quot;）进行运输，将货物运送到企业仓库进行储存和使用。该企业每年规划使用48周进行生产，考虑到需要保持生产活动的持续性，需要在生产活动的前24周制定各类原材料的订购和运输计划。

该企业每周的产能为2.82万立方米，每生产一立方米的产品需要消耗0.6立方米A类原材料、0.66立方米B类材料、0.72立方米C类原材料。由于原材料的特殊性，供货商可能存在不能完全按照企业提出的订货量需求进行供应的情况，既实际的供货量可能高出或者低于订货量。故在保证企业正常生产的前提下，该企业最好可以保持库存的原材料足够维持企业两周的生产所需，（三类原材料的储存和运输单价均相同）为此，企业通常对供货商提供的原材料全部收购。

在实际的运输过程中，原材料存在着一定的损耗（（损耗量/供货量） 的值称为&quot;损耗率&quot;），故企业仓库实际收到的由转运商所运输的货物数量称为&quot;接收量&quot;。每家转运商的货物转运能力均为6000立方米/周。在一般情况下，一家转运商一周只能运输一家供货商的货物。

原材料的采购成本将直接影响到企业的生产效益，且在实际中，A类与B类原材料的采购单价分别比C类原材料的高20%与10%。

## 1.2 问题提出

根据以上的背景及附件数据，需要解决以下四个问题：

1. 根据附件一，对文件中给出的402家供货商的供货特征进行量化分析，建立起基于保证企业正常生产重要性的数学模型，并在此基础上确定50家最重要的供货商，在论文中列表给出结果。
2. 参考上一问的结果，求解该企业至少需要选定多少家供应商进行原材料供应方可满足生产需要。并针对这些供货商，为企业制定未来24周每周的最经济的原料订购方案，并由该方案制定运输损耗最小的转运方案，最后分析方案的实际实施效果。
3. 该企业为了节省开支，压缩生产成本，现计划对A类原材料加大采购力度，同时对C类原材料的采购进行缩减，以此来减少运输及储存的成本，同时希望转运商在转运过程中对商品的损耗尽可能的减少。请制定新的订购方案及转运方案，最后分析方案的实际实施效果。
4. 该企业在技术改造后具备了提高产能的潜力。请根据现有的原材料供应商和转运商的实际情况，确定该企业每周产能的提高量，最后给出未来24周的订购和转运方案。

# 二、问题假设

假设1：各供货商和转运商的运营情况稳定，短时间不会出现破产情况；

假设2：忽略转运过程中出现交通事故导致原材料大规模损失的情况；

假设3：企业仓库足够大，能够全部接收供货商的原材料；

假设4：假设订货与供货都在一周内完成；

假设5：题目所给数据真实可靠；

# 三、符号说明

详见原文文档

注：未列出符号及重复符号以出现处标注为准

# 四、问题分析

## 4.1 问题一分析

为保障企业生产，对于供应链这一环最重要的就是保障原材料的供应。对于一家供应商来说，考量指标为供货能力和供货稳定性。原料供应能力表现为单次供应量的多少，供货稳定性表现为供应量与预定量的差值。当差值为负，即供应量小于预定量，企业就有由于原材料供应不足而导致产能不足的情况出现的可能性，故该种情况从根本上阻碍了企业生产，对企业影响较大。当差值为正，即供应量大于预定量，造成库存积压，增加成本，但不会影响企业的产能需求，且在本题中不考虑原料贮藏成本，所以此种情况对于企业生产影响较小。故建立函数 

表征供应商的供货稳定性。将建立评价模型对供应商进行评价，由于企业制造产品所需原料量不同，产品类别也直接影响了企业生产，则针对不同原材料进行加权处理，权重为



故选取供货能力、供货稳定性和供货类别为供应商的供货特征，对供应商特征进行量化分析，建立组合评价模型。对每家供应商依据已有的订货量、供货量数据进行评分，得分为S。S与供货能力、供货稳定性和权重呈正相关。企业应该选取有着较强的供货能力、供货稳定性较好的供应商来保证企业稳定生产。

## 4.2 问题二分析

问题二首先要求选择足够数量的供应商进行原材料供应，也就是各家供应商每周提供的原材料至少在理论上可以满足该企业每周的产能需求。在问题一建立的评价体系下，得到了排名前50的满足企业生产要求的供应商ID，那么这些&quot;优良&quot;供应商就是我们的重点考虑对象。

在对这些供应商五年来的供货曲线分析后，发现由这些供应商的供货特点可以将其分为三大类：第一是持续供货的稳定型供应商，第二是长时间不供货，但存在极大的供货峰值的突变型供应商（且其峰值的出现周期大约为12周一次），第三是既存在持续供货阶段，又具有较大供应能力的综合型供应商。在对供应商按照其提供的A、B、C类材料分类后，对每个供应商的供应量取周平均值（该供应商的总供货量/订货天数），并将供应量换算为对应的产能数据，按照产能从高到低的顺序相加，直至达到2.82万立方米的每周产能需求，便可求得供应商的最小数量。

题目还要求为该企业制定未来24周中每周的最经济原材料订购方案，则该方案的目标为最经济，既购买成本最小化，同时满足约束条件。故该问题转化为多层次单目标规划问题。其中，稳定型和综合型供应商的供货能力稳定，故作为长期供货目标进行选择。但由于原材料的特殊性导致的发货误差（该误差不可控，难以预测），存在导致库存量不足而影响生产的可能性，故突变型供应商作为产能不足预警出现时的补充，最后得到最经济的原材料订购方案。

在最优订购方案产生后，对附件二中各转运商的损耗率数据进行分析，得到转运商的优劣及其排名，则考虑让较优的转运企业优先选择订单，并尽可能的多运输原材料，以达到原材料损耗最小的目标。

## 问题三分析

该问要求尽可能的减少采购C类原材料，多采购A类原材料，则通过分析生产单位产品需要的三类原材料的量以及对应的成本价与运输估计费用（只与原材料量的多少有关）得到三类原材料对于该企业生产单位产品的经济数据。

在确定最优订购方案之前，首先在各家供应商的周平均供货值对应的产能之和满足企业的周产能需求前提下，优先对提供经济数据好的原材料的供应商进行选择。

在供应商选择完毕后，该题需要在订购方案最优的情况下，同时满足转运消耗最少，既订购方案的选定与转运方案的选定同时进行，总目标为订购原材料的费用与转运损耗带来的经济损失的和最小，故将该问题转化为单目标动态规划问题。

## 问题四分析

该企业具备提高产能的潜力，即产能不设上限，供货商为402家，通过计算，原料供给充足。则产能的提升取决于转运能力，那么让8家转运商均全力转运，以提升企业产能。产能与原料类别有关，由于原材料A、B、C生产单位产品所需的量依次降低。则应尽可能多的采购料A，其次为B和C。优先用转运损耗较小的转运商转运原料A，后调节原材料比例以及损耗量来提升产能。

# 五、问题一的模型建立与求解

## 5.1 问题分析

供应商的原材料供应能力对保障企业的正常生产具有重要影响，根据题目对产能的要求进行分析，供应商的考量指标为供货能力和供货稳定性，供货稳定性表现为供应量与预定量的差值。当差值为负数时，可能导致企业产能不足，故该情况一定会妨碍企业生产；当差值为正数时，有可能造成产品积压导致库存量上升，但至少不会影响企业的产能需求，且该问不考虑储存费用的影响，则该种情况对企业产生的影响较小。

故建立函数 

表征供应商的供货稳定性，建立评价模型对供应商进行评价。其次原材料类别也直接影响企业生产，则针对不同原材料进行加权处理。

选取供货能力、供货稳定性和供货类别为供应商的供货特征，对供应商特征进行量化分析，建立组合评价模型，得到供应商排名，企业择优进行选择。

图1问题一解决流程图

## 5.2 模型建立

设供货稳定性评价函数为 

其中：



依据 

对于供应能力的影响，当差值为负，即供应量小于预定量，从根本

上阻碍了企业生产，有出现企业产能不足的风险；当差值为正，即供应量大于预定量，易造成库存积压，增加生产成本，由于本题中不考虑原料储存成本，则该情况对于企业生产影响较小。

根据此特点， 选用指数函数模型。当 时，采用指数段的突变部分，当  时，采用指数函数中缓慢变化的部分。


确定不同类别原料权重 


由于企业对于生产每立方米产品需消耗 A 类原材料、B类原材料和C类原材料需求不同，则产品对于不同原材料的依赖性不同。制造每立方米产品需消耗原材料越少，则产品对于原材料的的依赖性越高，原材料对应权重越高；制造每立方米产品需消耗原材料越多，则产品对于原材料的的依赖性越高，原材料对应权重越低。（依赖性特指：缺少同样的量，对于产能的影响。）据此特点，三类原材料权重 

建立供应商综合评价模型

设供应商综合得分为S，S与供货能力、供货稳定性和权重呈正相关；设


n代表企业对供应商订货量不为0的总周数；

指供应量，代表供应商供货能力；

## 5.3 模型求解

求解供货稳定性评价函数

代表供货稳定性，取范围为[-1,1] 。

当预定量=供货量时，即 时，t=0，供货稳定性最佳，  。

当有订货没有供货时，即  时，t=-1，供货稳定性最差，为 

当预定量\&lt;供货量时，即 时，呈指数型缓慢变化曲线段；

当预定量\&gt;供货量时，即 时，呈指数型迅速变化曲线段。

根据以上特征，结合原料对于生产企业产能影响规律，解得:


图2 供货稳定性评价函数图

求解不同类别原料权重 


代入数据得：



化简并归一化，取值为：



求解供应商综合评价模型：



代入  得出供应商评价模型。

对402家供应商进行综合评价，进行得分排名，选出50名最重要供应商。50名最重要供应商如下表：

表1 50名供应商ID

| S229 | S131 | S307 | S040 | S086 |
| --- | --- | --- | --- | --- |
| S361 | S308 | S143 | S338 | S210 |
| S140 | S330 | S395 | S364 | S003 |
| S108 | S356 | S247 | S367 | S114 |
| S282 | S268 | S374 | S055 | S273 |
| S151 | S306 | S284 | S346 | S189 |
| S275 | S348 | S126 | S080 | S078 |
| S329 | S352 | S037 | S294 | S292 |
| S340 | S201 | S031 | S218 | S074 |
| S139 | S194 | S365 | S244 | S291 |

其中，通过对所选择重要企业进行分析可得，绘制出50家供应商的供货量方差与中位数可得，对于保障企业生产比较重要的企业大致分为两类：

第一类：可以长期稳定对企业进行供货，供货稳定性高的供应商，这类供应商方差较小，中位数较高（以S361为代表）

第二类：供货能力极强，可以满足企业超大订货需求的供应商，这类供应商与企业不进行稳定合作，却可以对企业提供关键帮助，供应紧急订单，这类供应商供货数据方差极大，中位数极小。（以S140为代表）



图3 50家供应商方差与中位数数据图


图4两类供应商的发货历史数据图（左一右二）

# 六、问题二的模型建立与求解

## 6.1 问题分析

题目要求求得最小的供应商数量，既在该数量的供应商进行供货的情况下，该企业的每周产能需求得以满足。又考虑到由于在订购方案欠佳的情况下，即使所选的供应商供货充足，也可能导致一些离散的产能不足的情况出现，故该问题求解时忽略订购方案不同带来的影响，只要所选各供应商的周平均供应量的总和达到企业的每日产能，则从理论上，这些供应商能够满足企业的生产需求，从而求得最小的供应商数量。

在对该企业未来24周的采购计划进行规划时，考虑到供应商的不同供应特点，我们将突变型供应商与稳定型、综合型供应商作为两大类考虑，对后者进行规划以保证供应总量的稳定性，突变型供应商作为产能储备不足预警情况出现时的补充，从而得到最优的订购方案。

在最优订购方案产生后，对转运商的相关数据进行分析，得到转运商的优劣，则最优的转运思路既为让较优的转运商优先进行转运选择，并尽可能饱和其转运能力，则该问题转化为损耗最小化的动态规划问题。

## 6.2 模型建立

6.2.1 确定供应商的最小数量

在第一问中得到的50家最重要的供应商中，对每个供应商的供货量对应的产能求周平均值 （j为附件一中供应商ID），对其由大到小顺序排序，得到序列 （i为排序的序号），则该企业产能的周平均值为 ，当满足以下条件时：
的值为所求的供应商最小数量。

6.2.2 最优订购方案规划问题模型建立

目标函数的确立：

该问的目标是确立前24周最经济的原材料选购方案，由于A、B、C类原材料的订购价格不同，且企业对原材料的生产种类不做改变，则最优化目标可以确立为从不同供应商中订购的A、B、C类原材料的订购价格之和最小，目标函数如下：



约束条件：

每周的订购方案应该保证至少不会影响企业的正常产能，并且企业每周的最大原材料数量不得超过八家转运商的单周最大转运能力，约束条件如下：


为满足库存至少够两周的生产所需，我们考虑在第一周就订购两周生产所需的原材料，故：

第一周的产能约束为： 


第一周的剩余产能：



第二周的产能约束为：



（12）（13）联立得：

）

同理得第三周的产能约束为：


第n周的产能约束为：



6.2.3 最优转运方案模型的建立

转运商数据分析：

通过对附件二中各家转运商5年来的运输损耗率作图如下：（以转运商1、4为代表）



图5转运商1的运输损耗率图


图6转运商4的运输损耗率图

可以发现，以转运商1、4为代表的各家转运商5年来的运输损耗率并没有显著的统计学分布规律。但对于不同的转运商而言，其损耗率的大小存在明显差异。下图为转运商2的运输损耗率图：


图7转运商2的运输损耗率图

将转运商1与转运商2的运输损耗率图像对比，可以明显发现转运商2的损耗率峰值数量更少，且大部的运输损耗率均小于转运商1的，故转运商2的转运可靠性（与原材料的运输损耗成反比）大于转运商1的。

对于转运商3来说，其运输损耗率在五年的时间内均居于较低水平，只有一个损耗率峰值出现，说明该转运商的转运能力也较为出色。下图为转运商3的运输损耗率图：



图8转运商3的运输损耗率图像

综合以上分析，我们选取各转运商5年来的运输损耗率周平均值（计算公式为：5年内企业的运输损耗率总和/运输天数）来反映转运商转运水平的优劣。

目标函数的确定：

该问题要求在最佳订购方案已经确定的情况下，确定最佳的转运方案，每家转运商的周平均转运损耗率为：



各转运商的优劣排名与  值的大小成反比。由于题目要求的时间周期为24周，附件二中给出了5年的损耗率数据，故我们考虑，某转运商在未来24周内出现的损耗率数据与过去5年的数据具有一定的映射关系。我们通过对过去五年非0的转运损耗率随机抽样，作为转运商未来24周的转运损耗率。则转运损耗最小化的目标函数如下：


约束条件：

在最优订购方案已经确定的情况下，问题求解需要满足的约束条件为：


其次考虑到转运商的转运能力差异，应当尽可能饱和优秀转运商的转运能力，既  的值尽可能小。

## 6.3 模型求解

6.3.1确定供应商的最小数量问题求解

将附件一数据依照要求带入上式计算，可得供应商的最小数量为23个，下面为得到的23家供应商的相关数据：

表2 求得的23家供应商数据表

| **供应商**** ID **|** 材料分类 **|** 供应商平均产能 **|** 累计产能** |
| --- | --- | --- | --- |
| **S229** | A | 2464.493 | 2464.493 |
| --- | --- | --- | --- |
| **S361** | C | 1898.611 | 4363.104 |
| **S140** | B | 2089.712 | 6452.816 |
| **S108** | B | 1521.149 | 7973.965 |
| **S282** | A | 1175.972 | 9149.938 |
| **S151** | C | 1125.567 | 10275.5 |
| **S275** | A | 1101.063 | 11376.57 |
| **S329** | A | 1086.931 | 12463.5 |
| **S340** | B | 1082.235 | 13545.73 |
| **S139** | B | 1036.459 | 14582.19 |
| **S131** | B | 868.1313 | 15450.32 |
| **S308** | B | 864.8864 | 16315.21 |
| **S330** | B | 862.702 | 17177.91 |
| **S356** | C | 754.0914 | 17932 |
| **S268** | C | 751.0764 | 18683.08 |
| **S306** | C | 729.7222 | 19412.8 |
| **S348** | A | 793.9948 | 20206.8 |
| **S352** | A | 618.2708 | 20825.07 |
| **S201** | A | 4880.298 | 25705.36 |
| **S194** | C | 586.603 | 26291.97 |
| **S307** | A | 762.1442 | 27054.11 |
| **S143** | A | 574.9097 | 27629.02 |
| **S395** | A | 1708.176 | 29337.2 |



图9 23家供应商的相关数据（图中最下的数据为供应商ID，均省略S）

6.3.2 最优订购方案规划问题模型求解

供应商按照其供货特点，分为两大类，第一类由稳定型与综合型供应商组成，第二类由突变型供应商组成。对附件一中供应商的历史供货数据进行分析后，将6.3.1中23家供应商依照供货类型进行分类，可得下表：

表3供应商的供应类型分类表

| 供应类型 | 供应商ID |
| --- | --- |
| 稳定型 | S229 S361 S282 S275 S329 S340 S131 S356 S268 S306 S352 S194 S143 S395 |
| 综合型 | S108 S201 S348 S330 S308 S151 |
| 突变型 | S140 S139 S307 |

将第一问得到的50家最重要公司5年来的供货量随时间变化的图像画出，可以清晰的得到三类供应商的供货特点如下:


图10稳定型供应商供货量数据图像


图11 综合型与突变型供应商供货量数据图像（左综右突）

转运商选择供应商供货，采用动态规划模型求解。将制定转运方案分为N次单个转运商匹配问题，转运商按照排名先后相对供应企业进行选择。

对于综合型供应商，可以发现，其在五年的时间内，出现供货量突变的次数极少，故在实际的订购过程中，这种微弱的突变性对订购方案的选择产生的影响极小，将该类型供应商其他时间的供货量的中位数代替其突变值，即可将综合型供应商视为稳定型供应商。

对于突变型供应商，采用遗传算法进行预估其订购量，从S108供应商供货量数据图像可以看到，其突变时间具有明显的周期性，集中体现出每12周一次的趋势，故定义突变型供应商产生突变，那么设定其既能够接收大额订单并及时供货的概率为  。对该类企业的供货突变值进行数据统计后，发现其大部突变值均超过了6000立方米/周（单个转运商的周转运最大值），则我们对选中的突变型原材料供应商的突变值均取2000-6000立方米/周，以便于在选择供货商时，避免出现向单家供应商发出超过单个转运商的周转运最大值的订单。且该类供应商只接收该突变值区间内的订单。

企业生产的第一周，由于没有储备，为保证接下来企业产能生产的稳定性，故企业在该周订购的原材料应该保证产能达到28200\*2立方米，在2.3.1中得到的23家供应商中，S108供应商为综合型企业，其具备较强的短期大量供应能力，故第一周选取S108企业，并向其订购6000立方米的原材料，以保证订购量的总量规模。

对于稳定型供应商，每周供货量比较稳定，采用蒙特卡洛算法，随机生成订购量，每周该公司宜向其订购5年内区间为0到单周最大供货量之间的随机订单，订单随机数生成符合正态分布，以正态分布概率随机生成其订购量。并且突变型企业以  的突变概率参与订单的接收，在上文给出的约束条件下，产生第一次的最优订购方案，得到一个最小收购成本


的值，再以同样的方法进行二次，三次…n次运算，每次都会得到一个最新的最小收购成本，并对最小收购成本进行更新，直至迭代次数达到1000次，则停止迭代，取最新的值为该周的最小收购成本，得到最优订购方案，进而进入下一周的规划。

求解思路如下图所示：


图12最优订购方案规划问题求解思路图

在进行大量的实验寻优后，我们发现稳定型供应商的订单均在其5年内供应峰值的40%-90%之间，故将每个供货商的随机订单的订购区间修改为该供应商5年内供应峰值的40%-90%之间，可以发现，其迭代求解次数大大减少，求解效率提高。

6.3.3 最优转运方案模型的求解

转运商转运水平的求解：

将附件二中转运商的运输损耗率带入6.2.3的对应计算公式中，求得八家转运商的周平均运输损耗率如下图所示：

图13 转运商的周平均运输损耗率

可得转运商的优劣顺序为（由优到劣顺序排列）：3、6、2、8、4、1、7、5

转运方案的求解：

Step1:

找到最优转运商，从6.3.2中找到该周的最优订购计划，对订购的原材料量按从大到小进行排序。

Step2：

首先将目前所剩的订单中原材料订购量最大的订单交给当前的最优转运商，判断转运商当前的剩余转运能力是否能够接收该订单，如果剩余转运能力足够，则接收该订单；若剩余转运能力不足以接收，则转向考虑仅次于该订单的订单，直至当周计划中原材料订购量最小的订单。

Step3：

若该周订单仍有剩余，则重复以上两步的步骤，直至该周的订单清零，则此时的转运方案既为该周最优的转运方案。

## 6.4 订购方案和转运方案的实施效果分析

问题二为两次单目标规划，第一个目标是每周订购方案最经济，即满足产能的条件下，运材料购买费用最经济。通过模型建立与求解可以得出，原材料购买费用最少为21825。
当理想情况下，即每周原材料对应产能刚好满足产能要求，准备两周的原料储备粮，且损耗率不计的情况下，原材料购买费用应该为：21150~21326 。费用接近，在误差范围内，说明该方案为最经济的原材料订购方案。
第二个目标为损耗率最小，根据损耗率定义，不考虑原材料种类。通过转运方案规划得到最小损耗方案，订购材料实际对应每周平均产能为：29940立方米。订购材料得满足两周的原料储备量，所以订购材料实际对应每周平均产能大于2.82万立方米。
在供应商全部可以按时按量供应的情况下,可以满足产能要求，保障企业生产。由于三类原材料运输和储存的单位费用相同，在订购方案最优情况下，运输存储费用为常数。满足要求前提下，原材料费用最低，损耗率最小，分别达到最优，所以该订购方案和转运方案的实施效果良好。

# 七、问题三的模型建立与求解

## 7.1 问题分析

在尽量多采购A类，少采购C类的要求下，分析三类原材料对于生产单位产品的经济数据，得到原则上企业选择原材料类型的倾向。以各供应商的周平均供货量对应的产能之和满足企业的周产能需求为前提，对原材料供给侧进行修改，既重新筛选符合要求的供应商。

由于题目要求在订购方案产生的同时，对转运方案进行规划，达到每周原材料订购费用与转运损耗造成的经济损失之和最小的目标，将问题转化为在该目标下的单目标动态规划问题。

## 7.2 模型建立

7.2.1 原材料供应商的选择

由于生产单位产品对三类原材料的需求，以及原材料价格各不相同等因素的影响，企业应当在经济角度考虑优先选择哪类原材料进行生产。下表为生产单位产品之于三类原材料的相关数据：（此处定义M与N分别为单价与运输+储存价格的单位）

表4 生产单位产品之于三类原材料的相关数据表

| 原材料类别 | 所需原材料量 | 单价 | 生产单位产品的成本 | 运输价格+储存价格 |
| --- | --- | --- | --- | --- |
| A | 0.6立方米 | 1.2M | 0.72M | 0.6N |
| B | 0.66立方米 | 1.1M | 0.726M | 0.66N |
| C | 0.72立方米 | 1M | 0.72M | 0.72N |

分别将三类原材料的生产单位产品的成本与运输+储存价格相加，得到该原材料的对于产品生产的经济数据，该数据越大，说明订购该原材料进行生产的成本更高。从该表中可知，欲生产单位产品，选择A类原材料与C类原材料的生产成本相同，但A类原材料的运输+储存价格更低，故企业选择A类原材料进行生产优于选择C类材料，与题目要求吻合，故生产产品的原材料选择为：A类最优，B类次之，C类最差。

与问题二类似，进行订购规划的前提是所选择供应商的周平均供货量的产能可以满足企业的周产能需求。在问题一求得的50家供应商中，以供应商供应原材料类型的不同将其分为A类、B类、C类供应商，首先在A类供应商中按照周平均供货量由高到低进行选择，其次是B类、C类供应商，直至其供货量之和对应的产能达到企业的周产能需求，这时选择出的供应商即纳入本题最优订购方案规划时考虑的供应商群体中。

7.2.2 约束条件的确定

该问的约束条件与第二问中订购与转运方案的约束条件相同，均为所制定的订购计划中，各供应商的周原料供应量之和能够满足企业的周产能需求，且单个供应商周接收订单的原材料订购总量小于等于其最大周转运能力（6000立方米）

7.2.3 目标函数的确立：

考虑在某订购方案下的原材料花费最少和对应于该订购方案的最优转运方案损耗造成的损失最小同时满足，则将两部分的支出（运输损耗视为额外支出）相加，之和最小的规划方案即为所求的方案。故该动态规划问题的目标函数如下：


该目标函数的 为原材料订购的费用，为转运商在转运过程中因原材料损耗而产生的损失费用，  为所求支出最小的目标函数。

## 7.3 模型求解

原材料供应商的确定：

在对问题一中筛选出的50家供应商按原材料供应类别进行分类后（且每类供应商内以周平均供应量由大到小顺序排列）根据7.2.1中依照A类、B类、C类供应商顺序进行选择的原则进行供应商筛选，直至选出的供应商的周平均供应量满足企业的周产能需求，共筛选出31家供应商进行原材料的供应。

总支出量最少（既目标函数最优解）的求解：

Step1:

在筛选出的31家供应商中，随机生成24周的订购方案。

Step2:

判断生成的订购方案是否满足产能与转运能力的约束条件，若不满足，则返回Step1，若满足，则按照6.2.3中寻求最优转运方案的思路为生成的订购方案寻求转运方案。

Step3:

j供应商在第i周的供应量可以由生成的订购方案确定，可以由匹配的最优转运方案找到j供应商在第i周的转运企业，从而得到 。既一旦订购方案与和其匹配的转运方案生成，就可以求得该方案下目标函数的最小值。并对该值进行动态更新。

Step4:

判断迭代次数是否大于1000次，若不够，则返回Step1;若够，则此时的订购方案与转运方案为所求最优方案。

## 6.4 订购方案和转运方案的实施效果分析

1、问题二中每周采购不同类别原材料周平均数量如下：

A类：8550立方米每周 B类：6757立方米每周 C类：4141立方米

问题三中每周采购不同类别原材料周平均数量如下：

A类：10525立方米每周 B类：7037立方米每周 C类：1563立方米

通过数据对比可以得出：问题三中采购方案A远多于C，有效减少了转运以及仓储成本。

2、本题为最经济且损耗率最低，建立动态规划模型。按照成本费用核算公式：

成本费用=原材料费用+损耗费用+运输存储费用

在最优情况下得出24周原材料成本费用总和为：533672

当采用问题二中分布规划计算的出最小成本费用为：544786

注：记原料C的单价为1

通过对比，在同时考虑订购以及转运的情况下，调控A、B、C采购比例，建模求出最优采购和转运方案，更有利于提高工厂产能和较少损耗和转运费用。

# 八、问题四的模型建立与求解

## 8.1 问题分析

在最大产能不设上限的情况下，对402家供货商供应的原材料产能计算了，以判断理论产能供应限制。

另外，产能的提升取决于转运能力，则8家转运商均全力转运，以提升企业产能。且由第三问对于三类原材料的分析可得，应尽可能多的采购料A，其次为B和C。优先选用转运损耗较小的转运商转运原料A，通过调节原材料比例以及损耗量来提升产能。

## 8.2 模型建立

8.2.1数据处理

对供应商重新进行评价，选用第一问中综合评价模型，根据综合得分对全部供应商进行排序。通过对排名情况以及该供应商过去五年供货量进行数据分析可得，排名靠后的供应商平均供货量很小，对于企业产能影响极小。故优先选用排名靠前的供货商进行供应。

8.2.2重要供应商选择

首先计算所有供应商的平均供货量，作为供应商供应能力的评价值 ，接着按照排名顺序计算累加平均供应能力 。已知共有8家转运商，每家转运商均以最高转运能力运转，最大转运能力为：


当累加平均供应能力 时，以上部分供应商可以满足转运能力最大的要求，将以上供货商选择为企业的重要供货商。

根据原材料种类对于产能的影响，应尽可能多的采购料A，其次为B和C。对以上重要供货商进行二次排序，在综合得分排名基础上，按照A、B、C的顺序进行二次数据排序，此数据即为重要供应商以及排名。并依据过去250周供货数据，以供货方差为依据，将供应商划分为稳定型供应商和突变型供应商。

8.2.3模型简化

1、由于产能不受限制，则对于原料需求量激增，所有转运商的转运能力均用于制造产品，来达到长期稳定高效生产，则不考虑满足两周生产需求的原材料库存量要求。

2、由于供应商分为稳定型供应商和应急性供应商，根据应急性供应商的特点，无法长期供应，可以短期内供应大量值。由于产能不受限制，则应急型供应商需要长期进行原料补充。在此问题中，将应急型供应商供应数据进行平稳化处理，使其既满足供应商生产原材料规律，又有利于进行原材料补充，使得最大限度达到最大转运能力，以增加企业产能。

8.2.3 寻找最优订购以及转运方案

1、初始化重要供应商可能的订货量：

取随机值，由于产能不受限制，则对于稳定型企业的订货量应大于过去订货的平均值，以增加原料供给量。初始化采用随机数法给出，根据过去250周供货数据，供货商的供货最大值很可能偏离整体数据，为了避免极端数据的影响，则选择中位数作为衡量指标。随机数选择中位数和1.5倍中位数之间的随机整数，以此值作为该供应商初始化数据。按照此规则对第一周选择的所有重要供应商进行初始化。

2、寻找最优转运方案：

为了达到产能最大，采用逆向选择思维，将供应商选择转运商转变为转运商选择供应商。

首先计算8家转运商的平均损耗，用来衡量该转运商的转运能力，进行排序。平均损耗率最小的转运商优先进行选择，依照供应商排序表的顺序依次选择，直至最大限度的满足最大转运量。

算法思路如下：



图14最优转运商的选择思路流程图

当剩余转运能力为0或者对所有供货商进行遍历完成之后，该转运商转运方案制定，由下一家转运商对剩余供货商进行选择。

按照此算法，平均损耗量小的转运商将优先运送A产品，损耗量最小，产能可达到最大，寻找出最优转运方案

。

3、寻找全局最优解：

在所给范围内，对重要供应商可能的订货量重新预测，，每次预测都按照供应商选择算法寻找最优配送方案，计算并记录每一周产能，据此求出该企业周平均产能。

目标函数即为周平均产能：

指的是所选择的供应商一周内不同原材料供应量

为不同原材料的损耗量

为对应原材料的产品转化率

计算迭代10000次， 即可找出使得产能最大的订购方案及转运方案。可提升产能即为：

：为目前企业每周的产能，为常数2.82万立方米

## 8.3 模型求解

8.3.1重要供货商选择

依照模型求解得到的转运商数据见支撑材料，下图为达到要求的截取部分：

图15 供应商相关数据图

由表可得，前134家供应商即可满足最大运力要求（在表中，供应商S017为第134家供应商），所以选择这134家供应商即可满足要求。

**8.3.2**** 最佳采购以及转运方案求解**

通过多次程序实验，当订购方案迭代10000次，就可以找到最佳的订购以及转运方案。

| 周数 | 平均产能 | 周数 | 平均产能 | 周数 | 平均产能 | 周数 | 平均产能 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 1 | 77482 | 7 | 77273 | 13 | 82157 | 19 | 76881 |
| 2 | 74899 | 8 | 79464 | 14 | 75774 | 20 | 79549 |
| 3 | 77772 | 9 | 77445 | 15 | 78266 | 21 | 77145 |
| 4 | 79811 | 10 | 75969 | 16 | 76471 | 22 | 76530 |
| 5 | 75126 | 11 | 76904 | 17 | 78666 | 23 | 75991 |
| 6 | 81203 | 12 | 77647 | 18 | 75658 | 24 | 74802 |

周7平均产能为：7.4万立方米

3、平均每周可提升产能：4.93万立方米

# 九、模型评价

## 9.1 模型优点

1、数据特征分析充分，根据以往转运商订货供货数据特点，考虑到生产过程中实际情况，将供应商分为稳定型供应商和实际型供应商，选择保障企业生产的重要供应商时，同时选择了两种供应商，并制定不同的订货策略，可以有效应对突发情况，更符合实际生产过程。
 2、损耗率采用随机抽样，在企业在选择转运商时，无法确定具体损耗率，只能通过以往数据进行评价，使得结果具有一定的随机性，更符合现实情况。
 3、采用蒙特卡洛算法和遗传算法，分别针对两种供应商，使得订购方案更科学。
 4、转运方案制定采用动态规划，兼顾效率与准确性。

## 9.2 模型缺点

1、在处理突变型供应商的供货数据时，具有一定的主观性。
 2、模型考虑的影响因素不够全，如仓储费用随时间的变化。
 3、多目标规划过程中，寻优复杂度较高，模型运行效率较低。

## 9.2 模型改进

1、算法合理调整参数，以提高运行效率
 2、优化算法结构，提高寻优准确性。

#


# 十、参考文献

[1] 司守奎. 数学建模算法与应用[M]. 北京：国防工业出版社. 2016-2.

[2] 葛显龙, 王伟鑫, 李顺勇. 智能算法及应用[M]. 陕西：西安交通大学出版社 2017-08.

# 附录

附录一：50家企业综合得分排名表

| 企业名称 | 综合得分 | 企业名称 | 综合得分 | 企业名称 | 综合得分 | 企业名称 | 综合得分 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| S229 | 316917.2435 | S356 | 96052.94439 | S037 | 35852.67231 | S086 | 10582.73309 |
| S361 | 225420.1526 | S268 | 95603.50132 | S031 | 34851.93137 | S210 | 9818.638453 |
| S140 | 224845.9604 | S306 | 93901.01957 | S365 | 31968.99077 | S003 | 9038.902209 |
| S108 | 195778.5333 | S348 | 83542.05506 | S040 | 30305.73908 | S114 | 8490.263903 |
| S282 | 156587.1989 | S352 | 76396.70446 | S338 | 23961.95622 | S273 | 8350.85536 |
| S151 | 145125.0488 | S201 | 75193.20529 | S364 | 21733.90959 | S189 | 8208.411534 |
| S275 | 140854.36 | S194 | 74765.6373 | S367 | 21661.38842 | S078 | 7153.26208 |
| S329 | 139104.1277 | S307 | 73326.15308 | S055 | 19579.47875 | S292 | 6910.421161 |
| S340 | 137802.0682 | S143 | 69338.65548 | S346 | 17308.15821 | S074 | 6907.022773 |
| S139 | 124401.6012 | S395 | 67788.08345 | S080 | 16284.18955 | S291 | 6873.309978 |
| S131 | 106515.8348 | S247 | 41520.27762 | S294 | 12436.92084 |
 |
 |
| S131 | 104000.9205 | S374 | 38473.73904 | S218 | 12286.25891 |
 |
 |
| S330 | 103851.5722 | S284 | 36199.1097 | S244 | 10623.68767 |
 |
